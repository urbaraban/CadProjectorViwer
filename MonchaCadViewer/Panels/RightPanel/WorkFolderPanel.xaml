<UserControl
    x:Class="CadProjectorViewer.Panels.RightPanel.WorkFolderPanel"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:modul="clr-namespace:CadProjectorViewer.ViewModel.Modules"
    xmlns:p="clr-namespace:System;assembly=mscorlib"
    xmlns:rightpanel="clr-namespace:CadProjectorViewer.Panels.RightPanel"
    xmlns:s="clr-namespace:System.Collections;assembly=mscorlib"
    d:DataContext="{d:DesignInstance Type={x:Type modul:WorkFolderList}}"
    d:DesignHeight="450"
    d:DesignWidth="200"
    mc:Ignorable="d">
    <UserControl.Resources>
        <ContextMenu x:Key="itemMenu">
            <MenuItem Command="{Binding OpenFolderCommand}" Header="Show folder..." />
            <MenuItem Command="{Binding OpenEditorCommand}" Header="Open editor" />
        </ContextMenu>
        <rightpanel:IconConverter x:Key="IconConverter" />
    </UserControl.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="133*" />
            <ColumnDefinition Width="68*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition Height="30" />
            <RowDefinition />
        </Grid.RowDefinitions>

        <DockPanel Grid.ColumnSpan="2">
            <Button
                Width="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                Margin="5"
                VerticalAlignment="Center"
                Command="{Binding RefreshListCommand}"
                Content="&#xEDAB;"
                DockPanel.Dock="Left"
                FontFamily="Segoe MDL2 Assets" />
            <Button
                Grid.Column="1"
                VerticalAlignment="Center"
                Command="{Binding SelectWorkFolderCommand}"
                Content="{DynamicResource m_Browse}"
                DockPanel.Dock="Right" />
            <Label VerticalContentAlignment="Center" Content="{Binding AlreadyDirectory.FullName, Mode=OneWay}" />
        </DockPanel>

        <ListView
            x:Name="WorkFolderListBox"
            Grid.Row="2"
            Grid.ColumnSpan="2"
            Margin="5,5,5,5"
            BorderBrush="LightGray"
            BorderThickness="1"
            ItemsSource="{Binding FilInfosCollection}"
            KeyUp="WorkFolderListBox_KeyUp">
            <ListView.View>
                <GridView>
                    <GridViewColumn Width="30">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock FontFamily="Segoe MDL2 Assets" Text="{Binding Path=Extension, Converter={StaticResource IconConverter}}" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                        <GridViewColumnHeader Click="GridViewColumnHeader_Click" Content="ic" />
                    </GridViewColumn>
                    <GridViewColumn Width="120" DisplayMemberBinding="{Binding Path=Name}">
                        <GridViewColumnHeader Click="GridViewColumnHeader_Click" Content="Name" />
                    </GridViewColumn>
                    <GridViewColumn Width="40" DisplayMemberBinding="{Binding Path=Extension}">
                        <GridViewColumnHeader Click="GridViewColumnHeader_Click" Content="Format" />
                    </GridViewColumn>
                    <GridViewColumn Width="Auto" DisplayMemberBinding="{Binding Path=LastWriteTime, StringFormat=HH:MM d.m.yy}">
                        <GridViewColumnHeader Click="GridViewColumnHeader_Click" Content="Date" />
                    </GridViewColumn>
                </GridView>
            </ListView.View>
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <EventSetter Event="MouseDoubleClick" Handler="ListViewItem_MouseDoubleClick" />
                    <Setter Property="ToolTip" Value="{Binding Path=FullName}" />
                    <Setter Property="ContextMenu" Value="{StaticResource itemMenu}" />
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>
        <DockPanel Grid.Row="1">
            <Button
                Width="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"
                Command="{Binding ClearFilterBoxCommand}"
                Content="X"
                DockPanel.Dock="Right" />
            <TextBox
                x:Name="WorkFolderFilter"
                Margin="5,2,1.5,2"
                VerticalContentAlignment="Center"
                DockPanel.Dock="Right"
                Focusable="True"
                GotFocus="WorkFolderFilter_GotFocus"
                KeyUp="WorkFolderFilter_KeyUp"
                Text="{Binding StringFilter, UpdateSourceTrigger=PropertyChanged}"
                TextWrapping="Wrap" />
        </DockPanel>
        <ComboBox
            Grid.Row="1"
            Grid.Column="1"
            Margin="4,2,5,0"
            VerticalAlignment="Center"
            DisplayMemberPath="Name"
            ItemsSource="{Binding Extensions}"
            SelectedItem="{Binding SelectExtension}" />
    </Grid>
</UserControl>
